import t from"crypto";import e from"tty";import n from"util";import r from"os";import o from"events";import i from"websocket-driver";import s from"stream";import a from"net";import c from"tls";import u from"url";import l from"http";import h from"https";import f from"websocket";import{DataSource as p,RectPath as d,Shape as m,Component as v}from"@hatiolab/things-scene";var g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var y,_={string:function(e){for(var n="abcdefghijklmnopqrstuvwxyz012345".length,r=t.randomBytes(e),o=[],i=0;i<e;i++)o.push("abcdefghijklmnopqrstuvwxyz012345".substr(r[i]%n,1));return o.join("")},number:function(t){return Math.floor(Math.random()*t)},numberString:function(t){var e=(""+(t-1)).length;return(new Array(e+1).join("0")+this.number(t)).slice(-e)}},w=b(function(t){var e={},n=!1,r=g.chrome&&g.chrome.app&&g.chrome.app.runtime;t.exports={attachEvent:function(t,e){void 0!==g.addEventListener?g.addEventListener(t,e,!1):g.document&&g.attachEvent&&(g.document.attachEvent("on"+t,e),g.attachEvent("on"+t,e))},detachEvent:function(t,e){void 0!==g.addEventListener?g.removeEventListener(t,e,!1):g.document&&g.detachEvent&&(g.document.detachEvent("on"+t,e),g.detachEvent("on"+t,e))},unloadAdd:function(t){if(r)return null;var o=_.string(8);return e[o]=t,n&&setTimeout(this.triggerUnloadCallbacks,0),o},unloadDel:function(t){t in e&&delete e[t]},triggerUnloadCallbacks:function(){for(var t in e)e[t](),delete e[t]}};r||t.exports.attachEvent("unload",function(){n||(n=!0,t.exports.triggerUnloadCallbacks())})}),E=(w.attachEvent,w.detachEvent,w.unloadAdd,w.unloadDel,w.triggerUnloadCallbacks,function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}),C=Object.prototype.hasOwnProperty;function O(t){return decodeURIComponent(t.replace(/\+/g," "))}var S={stringify:function(t,e){e=e||"";var n,r,o=[];for(r in"string"!=typeof e&&(e="?"),t)C.call(t,r)&&((n=t[r])||null!==n&&n!==y&&!isNaN(n)||(n=""),o.push(encodeURIComponent(r)+"="+encodeURIComponent(n)));return o.length?e+o.join("&"):""},parse:function(t){for(var e,n=/([^=?&]+)=?([^&]*)/g,r={};e=n.exec(t);){var o=O(e[1]),i=O(e[2]);o in r||(r[o]=i)}return r}},N=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,x=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,T=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],A={hash:1,query:1};function I(t){var e,n=("undefined"!=typeof window?window:void 0!==g?g:"undefined"!=typeof self?self:{}).location||{},r={},o=typeof(t=t||n);if("blob:"===t.protocol)r=new j(unescape(t.pathname),{});else if("string"===o)for(e in r=new j(t,{}),A)delete r[e];else if("object"===o){for(e in t)e in A||(r[e]=t[e]);void 0===r.slashes&&(r.slashes=x.test(t.href))}return r}function k(t){var e=N.exec(t);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],rest:e[3]}}function j(t,e,n){if(!(this instanceof j))return new j(t,e,n);var r,o,i,s,a,c,u=T.slice(),l=typeof e,h=0;for("object"!==l&&"string"!==l&&(n=e,e=null),n&&"function"!=typeof n&&(n=S.parse),e=I(e),r=!(o=k(t||"")).protocol&&!o.slashes,this.slashes=o.slashes||r&&e.slashes,this.protocol=o.protocol||e.protocol||"",t=o.rest,o.slashes||(u[3]=[/(.*)/,"pathname"]);h<u.length;h++)"function"!=typeof(s=u[h])?(i=s[0],c=s[1],i!=i?this[c]=t:"string"==typeof i?~(a=t.indexOf(i))&&("number"==typeof s[2]?(this[c]=t.slice(0,a),t=t.slice(a+s[2])):(this[c]=t.slice(a),t=t.slice(0,a))):(a=i.exec(t))&&(this[c]=a[1],t=t.slice(0,a.index)),this[c]=this[c]||r&&s[3]&&e[c]||"",s[4]&&(this[c]=this[c].toLowerCase())):t=s(t);n&&(this.query=n(this.query)),r&&e.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==e.pathname)&&(this.pathname=function(t,e){for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,o=n[r-1],i=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(i=!0),n.splice(r,1),s--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(this.pathname,e.pathname)),E(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(s=this.auth.split(":"),this.username=s[0]||"",this.password=s[1]||""),this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString()}j.prototype={set:function(t,e,n){switch(t){case"query":"string"==typeof e&&e.length&&(e=(n||S.parse)(e)),this[t]=e;break;case"port":this[t]=e,E(e,this.protocol)?e&&(this.host=this.hostname+":"+e):(this.host=this.hostname,this[t]="");break;case"hostname":this[t]=e,this.port&&(e+=":"+this.port),this.host=e;break;case"host":this[t]=e,/:\d+$/.test(e)?(e=e.split(":"),this.port=e.pop(),this.hostname=e.join(":")):(this.hostname=e,this.port="");break;case"protocol":this.protocol=e.toLowerCase(),this.slashes=!n;break;case"pathname":case"hash":if(e){var r="pathname"===t?"/":"#";this[t]=e.charAt(0)!==r?r+e:e}else this[t]=e;break;default:this[t]=e}for(var o=0;o<T.length;o++){var i=T[o];i[4]&&(this[i[1]]=this[i[1]].toLowerCase())}return this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(t){t&&"function"==typeof t||(t=S.stringify);var e,n=this.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var r=n+(this.slashes?"//":"");return this.username&&(r+=this.username,this.password&&(r+=":"+this.password),r+="@"),r+=this.host+this.pathname,(e="object"==typeof this.query?t(this.query):this.query)&&(r+="?"!==e.charAt(0)?"?"+e:e),this.hash&&(r+=this.hash),r}},j.extractProtocol=k,j.location=I,j.qs=S;var L=j,F=1e3,P=60*F,R=60*P,D=24*R,M=7*D,U=365.25*D,V=function(t,e){e=e||{};var n=typeof t;if("string"===n&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*U;case"weeks":case"week":case"w":return n*M;case"days":case"day":case"d":return n*D;case"hours":case"hour":case"hrs":case"hr":case"h":return n*R;case"minutes":case"minute":case"mins":case"min":case"m":return n*P;case"seconds":case"second":case"secs":case"sec":case"s":return n*F;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(t);if("number"===n&&!1===isNaN(t))return e.long?function(t){var e=Math.abs(t);if(e>=D)return G(t,e,D,"day");if(e>=R)return G(t,e,R,"hour");if(e>=P)return G(t,e,P,"minute");if(e>=F)return G(t,e,F,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=D)return Math.round(t/D)+"d";if(e>=R)return Math.round(t/R)+"h";if(e>=P)return Math.round(t/P)+"m";if(e>=F)return Math.round(t/F)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function G(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}var W=function(t){function e(t){for(var e=0,r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return n.colors[Math.abs(e)%n.colors.length]}function n(t){var i;function s(){if(s.enabled){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var o=s,a=Number(new Date),c=a-(i||a);o.diff=c,o.prev=i,o.curr=a,i=a,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var u=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(t,r){if("%%"===t)return t;u++;var i=n.formatters[r];if("function"==typeof i){var s=e[u];t=i.call(o,s),e.splice(u,1),u--}return t}),n.formatArgs.call(o,e),(o.log||n.log).apply(o,e)}}return s.namespace=t,s.enabled=n.enabled(t),s.useColors=n.useColors(),s.color=e(t),s.destroy=r,s.extend=o,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function r(){var t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}function o(t,e){return n(this.namespace+(void 0===e?":":e)+t)}return n.debug=n,n.default=n,n.coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){n.enable("")},n.enable=function(t){var e;n.save(t),n.names=[],n.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(e=0;e<o;e++)r[e]&&("-"===(t=r[e].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(e=0;e<n.instances.length;e++){var i=n.instances[e];i.enabled=n.enabled(i.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;var e,r;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=V,Object.keys(t).forEach(function(e){n[e]=t[e]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=e,n.enable(n.load()),n},q=b(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.log=function(){var t;return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&(t=console).log.apply(t,arguments)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))}),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(t){}!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=W(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}),B=(q.log,q.formatArgs,q.save,q.load,q.useColors,q.storage,q.colors,(t,e)=>{e=e||process.argv;const n=t.startsWith("-")?"":1===t.length?"-":"--",r=e.indexOf(n+t),o=e.indexOf("--");return-1!==r&&(-1===o||r<o)});const z=process.env;let J;function H(t){return function(t){return 0!==t&&{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}(function(t){if(!1===J)return 0;if(B("color=16m")||B("color=full")||B("color=truecolor"))return 3;if(B("color=256"))return 2;if(t&&!t.isTTY&&!0!==J)return 0;const e=J?1:0;if("win32"===process.platform){const t=r.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(t[0])>=10&&Number(t[2])>=10586?Number(t[2])>=14931?3:2:1}if("CI"in z)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(t=>t in z)||"codeship"===z.CI_NAME?1:e;if("TEAMCITY_VERSION"in z)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(z.TEAMCITY_VERSION)?1:0;if("truecolor"===z.COLORTERM)return 3;if("TERM_PROGRAM"in z){const t=parseInt((z.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(z.TERM_PROGRAM){case"iTerm.app":return t>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(z.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(z.TERM)?1:"COLORTERM"in z?1:(z.TERM,e)}(t))}B("no-color")||B("no-colors")||B("color=false")?J=!1:(B("color")||B("colors")||B("color=true")||B("color=always"))&&(J=!0),"FORCE_COLOR"in z&&(J=0===z.FORCE_COLOR.length||0!==parseInt(z.FORCE_COLOR,10));var Z={supportsColor:H,stdout:H(process.stdout),stderr:H(process.stderr)},Q=b(function(t,r){r.init=function(t){t.inspectOpts={};for(var e=Object.keys(r.inspectOpts),n=0;n<e.length;n++)t.inspectOpts[e[n]]=r.inspectOpts[e[n]]},r.log=function(){return process.stderr.write(n.format.apply(n,arguments)+"\n")},r.formatArgs=function(e){var n=this.namespace;if(this.useColors){var o=this.color,i="[3"+(o<8?o:"8;5;"+o),s="  ".concat(i,";1m").concat(n," [0m");e[0]=s+e[0].split("\n").join("\n"+s),e.push(i+"m+"+t.exports.humanize(this.diff)+"[0m")}else e[0]=function(){if(r.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+e[0]},r.save=function(t){t?process.env.DEBUG=t:delete process.env.DEBUG},r.load=function(){return process.env.DEBUG},r.useColors=function(){return"colors"in r.inspectOpts?Boolean(r.inspectOpts.colors):e.isatty(process.stderr.fd)},r.colors=[6,2,3,4,5,1];try{Z&&(Z.stderr||Z).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(t){}r.inspectOpts=Object.keys(process.env).filter(function(t){return/^debug_/i.test(t)}).reduce(function(t,e){var n=e.substring(6).toLowerCase().replace(/_([a-z])/g,function(t,e){return e.toUpperCase()}),r=process.env[e];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),t[n]=r,t},{}),t.exports=W(r);var o=t.exports.formatters;o.o=function(t){return this.inspectOpts.colors=this.useColors,n.inspect(t,this.inspectOpts).replace(/\s*\n\s*/g," ")},o.O=function(t){return this.inspectOpts.colors=this.useColors,n.inspect(t,this.inspectOpts)}}),X=(Q.init,Q.log,Q.formatArgs,Q.save,Q.load,Q.useColors,Q.colors,Q.inspectOpts,b(function(t){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?t.exports=q:t.exports=Q})),Y=function(){};"production"!==process.env.NODE_ENV&&(Y=X("sockjs-client:utils:url"));var K={getOrigin:function(t){if(!t)return null;var e=new L(t);if("file:"===e.protocol)return null;var n=e.port;return n||(n="https:"===e.protocol?"443":"80"),e.protocol+"//"+e.hostname+":"+n},isOriginEqual:function(t,e){var n=this.getOrigin(t)===this.getOrigin(e);return Y("same",t,e,n),n},isSchemeEqual:function(t,e){return t.split(":")[0]===e.split(":")[0]},addPath:function(t,e){var n=t.split("?");return n[0]+e+(n[1]?"?"+n[1]:"")},addQuery:function(t,e){return t+(-1===t.indexOf("?")?"?"+e:"&"+e)}},$=b(function(t){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}),tt=b(function(t){try{var e=n;if("function"!=typeof e.inherits)throw"";t.exports=e.inherits}catch(e){t.exports=$}}),et=function(t,e){for(var n in this.type=t,e)this[n]=e[n]};et.prototype.initEvent=function(t,e,n){this.type=t,this.bubbles=e,this.cancelable=n},et.prototype.stopPropagation=function(){},et.prototype.preventDefault=function(){},et.CAPTURING_PHASE=1,et.AT_TARGET=2,et.BUBBLING_PHASE=3;var nt=et,rt={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(t,e,n){this.on(t,e)},removeEventListener:function(t,e,n){this.removeListener(t,e)},dispatchEvent:function(t){t.target=t.currentTarget=this,t.eventPhase=nt.AT_TARGET,this["on"+t.type]&&this["on"+t.type](t),this.emit(t.type,t)}},ot=s.Stream,it=function(t){t=t||{},i.validateOptions(t,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var e=t.headers;if(e)for(var n in e)this._driver.setHeader(n,e[n]);var r=t.extensions;r&&[].concat(r).forEach(this._driver.addExtension,this._driver),this._ping=t.ping,this._pingId=0,this.readyState=it.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var o=this;this._driver.on("open",function(t){o._open()}),this._driver.on("message",function(t){o._receiveMessage(t.data)}),this._driver.on("close",function(t){o._beginClose(t.reason,t.code)}),this._driver.on("error",function(t){o._emitError(t.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){o.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){o._pingId+=1,o.ping(o._pingId.toString())},1e3*this._ping)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};n.inherits(it,ot),it.CONNECTING=0,it.OPEN=1,it.CLOSING=2,it.CLOSED=3,it.CLOSE_TIMEOUT=3e4;var st={write:function(t){return this.send(t)},end:function(t){void 0!==t&&this.send(t),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(t){return!(this.readyState>it.OPEN)&&(t instanceof Buffer||(t=String(t)),this._driver.messages.write(t))},ping:function(t,e){return!(this.readyState>it.OPEN)&&this._driver.ping(t,e)},close:function(t,e){if(void 0===t&&(t=1e3),void 0===e&&(e=""),1e3!==t&&(t<3e3||t>4999))throw new Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+t+" is neither.");this.readyState!==it.CLOSED&&(this.readyState=it.CLOSING),this._driver.close(e,t);var n=this;this._closeTimer=setTimeout(function(){n._beginClose("",1006)},it.CLOSE_TIMEOUT)},_configureStream:function(){var t=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(e){this._stream.on(e,function(){t._finalizeClose()})},this),this._stream.on("error",function(e){t._emitError("Network error: "+t.url+": "+e.message),t._finalizeClose()})},_open:function(){if(this.readyState===it.CONNECTING){this.readyState=it.OPEN,this.protocol=this._driver.protocol||"";var t=new nt("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},_receiveMessage:function(t){if(this.readyState>it.OPEN)return!1;this.readable&&this.emit("data",t);var e=new nt("message",{data:t});e.initEvent("message",!1,!1),this.dispatchEvent(e)},_emitError:function(t){if(!(this.readyState>=it.CLOSING)){var e=new nt("error",{message:t});e.initEvent("error",!1,!1),this.dispatchEvent(e)}},_beginClose:function(t,e){this.readyState!==it.CLOSED&&(this.readyState=it.CLOSING,this._closeParams=[t,e],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==it.CLOSED){this.readyState=it.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var t=this._closeParams?this._closeParams[0]:"",e=this._closeParams?this._closeParams[1]:1006,n=new nt("close",{code:e,reason:t});n.initEvent("close",!1,!1),this.dispatchEvent(n)}}};for(var at in st)it.prototype[at]=st[at];for(var ct in rt)it.prototype[ct]=rt[ct];var ut=it,lt={"http:":80,"https:":443,"ws:":80,"wss:":443},ht=["https:","wss:"],ft=function(t,e,n){n=n||{},this.url=t,this._driver=i.client(this.url,{maxLength:n.maxLength,protocols:e}),["open","error"].forEach(function(t){this._driver.on(t,function(){m.headers=m._driver.headers,m.statusCode=m._driver.statusCode})},this);var r=n.proxy||{},o=u.parse(r.origin||this.url),s=o.port||lt[o.protocol],l=ht.indexOf(o.protocol)>=0,h=function(){m._onConnect()},f=n.net||{},p=n.tls||{},d=r.origin?r.tls||{}:p,m=this;f.host=d.host=o.hostname,f.port=d.port=s,p.ca=p.ca||n.ca,d.servername=d.servername||o.hostname,this._stream=l?c.connect(d,h):a.connect(f,h),r.origin&&this._configureProxy(r,p),ut.call(this,n)};n.inherits(ft,ut),ft.prototype._onConnect=function(){(this._proxy||this._driver).start()},ft.prototype._configureProxy=function(t,e){var n,r=u.parse(this.url),o=ht.indexOf(r.protocol)>=0,i=this;if(this._proxy=this._driver.proxy(t.origin),t.headers)for(n in t.headers)this._proxy.setHeader(n,t.headers[n]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(o){var t={socket:i._stream,servername:r.hostname};for(n in e)t[n]=e[n];i._stream=c.connect(t),i._configureStream()}i._driver.io.pipe(i._stream),i._stream.pipe(i._driver.io),i._driver.start()}),this._proxy.on("error",function(t){i._driver.emit("error",t)})};var pt=ft,dt=function(){this.clear()};dt.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"],dt.prototype.clear=function(){this._sent={},this._lines=[]},dt.prototype.set=function(t,e){if(void 0!==e){t=this._strip(t),e=this._strip(e);var n=t.toLowerCase();(!this._sent.hasOwnProperty(n)||this.ALLOWED_DUPLICATES.indexOf(n)>=0)&&(this._sent[n]=!0,this._lines.push(t+": "+e+"\r\n"))}},dt.prototype.toString=function(){return this._lines.join("")},dt.prototype._strip=function(t){return t.toString().replace(/^ */,"").replace(/ *$/,"")};var mt=dt,vt=s.Stream,gt=function(t,e,n){this.writable=!0,n=n||{},this._stream=e.socket,this._ping=n.ping||this.DEFAULT_PING,this._retry=n.retry||this.DEFAULT_RETRY;var r=i.isSecureRequest(t)?"https:":"http:";this.url=r+"//"+t.headers.host+t.url,this.lastEventId=t.headers["last-event-id"]||"",this.readyState=ut.CONNECTING;var o=new mt,s=this;if(n.headers)for(var a in n.headers)o.set(a,n.headers[a]);if(this._stream&&this._stream.writable){process.nextTick(function(){s._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var c="HTTP/1.1 200 OK\r\nContent-Type: text/event-stream\r\nCache-Control: no-cache, no-store\r\nConnection: close\r\n"+o.toString()+"\r\nretry: "+Math.floor(1e3*this._retry)+"\r\n\r\n";this._write(c),this._stream.on("drain",function(){s.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){s.ping()},1e3*this._ping)),["error","end"].forEach(function(t){s._stream.on(t,function(){s.close()})})}};n.inherits(gt,vt),gt.isEventSource=function(t){return"GET"===t.method&&(t.headers.accept||"").split(/\s*,\s*/).indexOf("text/event-stream")>=0};var bt={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(t){if(!this.writable)return!1;try{return this._stream.write(t,"utf8")}catch(t){return!1}},_open:function(){if(this.readyState===ut.CONNECTING){this.readyState=ut.OPEN;var t=new nt("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},write:function(t){return this.send(t)},end:function(t){void 0!==t&&this.write(t),this.close()},send:function(t,e){if(this.readyState>ut.OPEN)return!1;t=String(t).replace(/(\r\n|\r|\n)/g,"$1data: ");var n="";return(e=e||{}).event&&(n+="event: "+e.event+"\r\n"),e.id&&(n+="id: "+e.id+"\r\n"),n+="data: "+t+"\r\n\r\n",this._write(n)},ping:function(){return this._write(":\r\n\r\n")},close:function(){if(this.readyState>ut.OPEN)return!1;this.readyState=ut.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var t=new nt("close");return t.initEvent("close",!1,!1),this.dispatchEvent(t),!0}};for(var yt in bt)gt.prototype[yt]=bt[yt];for(var _t in rt)gt.prototype[_t]=rt[_t];var wt=gt,Et=function(t,e,n,r,o){o=o||{},this._stream=e,this._driver=i.http(t,{maxLength:o.maxLength,protocols:r});var s=this;if(this._stream&&this._stream.writable){if(!this._stream.readable)return this._stream.end();var a=function(){s._stream.removeListener("data",a)};this._stream.on("data",a),ut.call(this,o),process.nextTick(function(){s._driver.start(),s._driver.io.write(n)})}};n.inherits(Et,ut),Et.isWebSocket=function(t){return i.isWebSocket(t)},Et.validateOptions=function(t,e){i.validateOptions(t,e)},Et.WebSocket=Et,Et.Client=pt,Et.EventSource=wt;var Ct=Et.Client,Ot=o.EventEmitter,St=function(){};function Nt(t,e,n){if(!Nt.enabled())throw new Error("Transport created when disabled");Ot.call(this),St("constructor",t);var r=this,o=K.addPath(t,"/websocket");o="https"===o.slice(0,5)?"wss"+o.slice(5):"ws"+o.slice(4),this.url=o,this.ws=new Ct(this.url,[],n),this.ws.onmessage=function(t){St("message event",t.data),r.emit("message",t.data)},this.unloadRef=w.unloadAdd(function(){St("unload"),r.ws.close()}),this.ws.onclose=function(t){St("close event",t.code,t.reason),r.emit("close",t.code,t.reason),r._cleanup()},this.ws.onerror=function(t){St("error event",t),r.emit("close",1006,"WebSocket connection broken"),r._cleanup()}}"production"!==process.env.NODE_ENV&&(St=X("sockjs-client:websocket")),tt(Nt,Ot),Nt.prototype.send=function(t){var e="["+t+"]";St("send",e),this.ws.send(e)},Nt.prototype.close=function(){St("close");var t=this.ws;this._cleanup(),t&&t.close()},Nt.prototype._cleanup=function(){St("_cleanup");var t=this.ws;t&&(t.onmessage=t.onclose=t.onerror=null),w.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},Nt.enabled=function(){return St("enabled"),!!Ct},Nt.transportName="websocket",Nt.roundTrips=2;var xt=Nt,Tt=o.EventEmitter,At=function(){};function It(t,e){At(t),Tt.call(this),this.sendBuffer=[],this.sender=e,this.url=t}"production"!==process.env.NODE_ENV&&(At=X("sockjs-client:buffered-sender")),tt(It,Tt),It.prototype.send=function(t){At("send",t),this.sendBuffer.push(t),this.sendStop||this.sendSchedule()},It.prototype.sendScheduleWait=function(){At("sendScheduleWait");var t,e=this;this.sendStop=function(){At("sendStop"),e.sendStop=null,clearTimeout(t)},t=setTimeout(function(){At("timeout"),e.sendStop=null,e.sendSchedule()},25)},It.prototype.sendSchedule=function(){At("sendSchedule",this.sendBuffer.length);var t=this;if(this.sendBuffer.length>0){var e="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,e,function(e){t.sendStop=null,e?(At("error",e),t.emit("close",e.code||1006,"Sending error: "+e),t.close()):t.sendScheduleWait()}),this.sendBuffer=[]}},It.prototype._cleanup=function(){At("_cleanup"),this.removeAllListeners()},It.prototype.close=function(){At("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)};var kt=It,jt=o.EventEmitter,Lt=function(){};function Ft(t,e,n){Lt(e),jt.call(this),this.Receiver=t,this.receiveUrl=e,this.AjaxObject=n,this._scheduleReceiver()}"production"!==process.env.NODE_ENV&&(Lt=X("sockjs-client:polling")),tt(Ft,jt),Ft.prototype._scheduleReceiver=function(){Lt("_scheduleReceiver");var t=this,e=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);e.on("message",function(e){Lt("message",e),t.emit("message",e)}),e.once("close",function(n,r){Lt("close",n,r,t.pollIsClosing),t.poll=e=null,t.pollIsClosing||("network"===r?t._scheduleReceiver():(t.emit("close",n||1006,r),t.removeAllListeners()))})},Ft.prototype.abort=function(){Lt("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()};var Pt=Ft,Rt=function(){};function Dt(t,e,n,r,o){var i=K.addPath(t,e);Rt(i);var s=this;kt.call(this,t,n),this.poll=new Pt(r,i,o),this.poll.on("message",function(t){Rt("poll message",t),s.emit("message",t)}),this.poll.once("close",function(t,e){Rt("poll close",t,e),s.poll=null,s.emit("close",t,e),s.close()})}"production"!==process.env.NODE_ENV&&(Rt=X("sockjs-client:sender-receiver")),tt(Dt,kt),Dt.prototype.close=function(){kt.prototype.close.call(this),Rt("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)};var Mt=Dt,Ut=function(){};function Vt(t,e,n,r){Mt.call(this,t,e,function(t){return function(e,n,r){Ut("create ajax sender",e,n);var o={};"string"==typeof n&&(o.headers={"Content-type":"text/plain"});var i=K.addPath(e,"/xhr_send"),s=new t("POST",i,n,o);return s.once("finish",function(t){if(Ut("finish",t),s=null,200!==t&&204!==t)return r(new Error("http status "+t));r()}),function(){Ut("abort"),s.close(),s=null;var t=new Error("Aborted");t.code=1e3,r(t)}}}(r),n,r)}"production"!==process.env.NODE_ENV&&(Ut=X("sockjs-client:ajax-based")),tt(Vt,Mt);var Gt=Vt,Wt=o.EventEmitter,qt=function(){};function Bt(t,e){qt(t),Wt.call(this);var n=this;this.bufferPosition=0,this.xo=new e("POST",t,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(t,e){qt("finish",t,e),n._chunkHandler(t,e),n.xo=null;var r=200===t?"network":"permanent";qt("close",r),n.emit("close",null,r),n._cleanup()})}"production"!==process.env.NODE_ENV&&(qt=X("sockjs-client:receiver:xhr")),tt(Bt,Wt),Bt.prototype._chunkHandler=function(t,e){if(qt("_chunkHandler",t),200===t&&e)for(var n=-1;;this.bufferPosition+=n+1){var r=e.slice(this.bufferPosition);if(-1===(n=r.indexOf("\n")))break;var o=r.slice(0,n);o&&(qt("message",o),this.emit("message",o))}},Bt.prototype._cleanup=function(){qt("_cleanup"),this.removeAllListeners()},Bt.prototype.abort=function(){qt("abort"),this.xo&&(this.xo.close(),qt("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()};var zt=Bt,Jt=o.EventEmitter,Ht=function(){};function Zt(t,e,n,r){Ht(t,e,n);var o=this;Jt.call(this);var i=new L(e),s={method:t,hostname:i.hostname.replace(/\[|\]/g,""),port:i.port,path:i.pathname+(i.query||""),headers:r&&r.headers,agent:!1},a="https:"===i.protocol?h:l;this.req=a.request(s,function(t){t.setEncoding("utf8");var e="";t.on("data",function(t){Ht("data",t),e+=t,o.emit("chunk",200,e)}),t.once("end",function(){Ht("end"),o.emit("finish",t.statusCode,e),o.req=null})}),this.req.on("error",function(t){Ht("error",t),o.emit("finish",0,t.message)}),n&&this.req.write(n),this.req.end()}"production"!==process.env.NODE_ENV&&(Ht=X("sockjs-client:driver:xhr")),tt(Zt,Jt),Zt.prototype.close=function(){Ht("close"),this.removeAllListeners(),this.req&&(this.req.abort(),this.req=null)},Zt.enabled=!0,Zt.supportsCORS=!0;var Qt=Zt;function Xt(t,e,n,r){Qt.call(this,t,e,n,r)}tt(Xt,Qt),Xt.enabled=Qt.enabled&&Qt.supportsCORS;var Yt=Xt;function Kt(t,e,n){Qt.call(this,t,e,n,{noCredentials:!0})}tt(Kt,Qt),Kt.enabled=Qt.enabled;var $t=Kt,te={isOpera:function(){return g.navigator&&/opera/i.test(g.navigator.userAgent)},isKonqueror:function(){return g.navigator&&/konqueror/i.test(g.navigator.userAgent)},hasDomain:function(){if(!g.document)return!0;try{return!!g.document.domain}catch(t){return!1}}};function ee(t){if(!$t.enabled&&!Yt.enabled)throw new Error("Transport created when disabled");Gt.call(this,t,"/xhr_streaming",zt,Yt)}tt(ee,Gt),ee.enabled=function(t){return!t.nullOrigin&&(!te.isOpera()&&Yt.enabled)},ee.transportName="xhr-streaming",ee.roundTrips=2,ee.needBody=!!g.document;var ne=ee,re=o.EventEmitter,oe=function(){};function ie(t,e,n){oe(t,e);var r=this;re.call(this),setTimeout(function(){r._start(t,e,n)},0)}"production"!==process.env.NODE_ENV&&(oe=X("sockjs-client:sender:xdr")),tt(ie,re),ie.prototype._start=function(t,e,n){oe("_start");var r=this,o=new g.XDomainRequest;e=K.addQuery(e,"t="+ +new Date),o.onerror=function(){oe("onerror"),r._error()},o.ontimeout=function(){oe("ontimeout"),r._error()},o.onprogress=function(){oe("progress",o.responseText),r.emit("chunk",200,o.responseText)},o.onload=function(){oe("load"),r.emit("finish",200,o.responseText),r._cleanup(!1)},this.xdr=o,this.unloadRef=w.unloadAdd(function(){r._cleanup(!0)});try{this.xdr.open(t,e),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(n)}catch(t){this._error()}},ie.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},ie.prototype._cleanup=function(t){if(oe("cleanup",t),this.xdr){if(this.removeAllListeners(),w.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,t)try{this.xdr.abort()}catch(t){}this.unloadRef=this.xdr=null}},ie.prototype.close=function(){oe("close"),this._cleanup(!0)},ie.enabled=!(!g.XDomainRequest||!te.hasDomain());var se=ie;function ae(t){if(!se.enabled)throw new Error("Transport created when disabled");Gt.call(this,t,"/xhr_streaming",zt,se)}tt(ae,Gt),ae.enabled=function(t){return!t.cookie_needed&&!t.nullOrigin&&(se.enabled&&t.sameScheme)},ae.transportName="xdr-streaming",ae.roundTrips=2;var ce=ae;function ue(t){return"string"==typeof t&&(t=L(t)),t.protocol&&t.hostname?(t.protocol+"//"+t.host).toLowerCase():"null"}ue.same=function(t,e){return ue(t)===ue(e)};var le=ue,he=u.parse,fe=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],pe=[239,187,191],de=58,me=32,ve=10,ge=13;function be(t,e){var n=be.CONNECTING;Object.defineProperty(this,"readyState",{get:function(){return n}}),Object.defineProperty(this,"url",{get:function(){return t}});var r,o=this;function i(e){n!==be.CLOSED&&(n=be.CONNECTING,d("error",new _e("error",{message:e})),f&&(t=f,f=null),setTimeout(function(){n===be.CONNECTING&&p()},o.reconnectInterval))}o.reconnectInterval=1e3;var s="";e&&e.headers&&e.headers["Last-Event-ID"]&&(s=e.headers["Last-Event-ID"],delete e.headers["Last-Event-ID"]);var a=!1,c="",u="",f=null;function p(){var c=he(t),u="https:"===c.protocol;if(c.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},s&&(c.headers["Last-Event-ID"]=s),e&&e.headers)for(var v in e.headers){var g=e.headers[v];g&&(c.headers[v]=g)}if(c.rejectUnauthorized=!(e&&!e.rejectUnauthorized),e&&e.proxy){var b=he(e.proxy);u="https:"===b.protocol,c.protocol=u?"https:":"http:",c.path=t,c.headers.Host=c.host,c.hostname=b.hostname,c.host=b.host,c.port=b.port}if(e&&e.https)for(var y in e.https)if(-1!==fe.indexOf(y)){var _=e.https[y];void 0!==_&&(c[y]=_)}e&&void 0!==e.withCredentials&&(c.withCredentials=e.withCredentials),(r=(u?h:l).request(c,function(e){if(500===e.statusCode||502===e.statusCode||503===e.statusCode||504===e.statusCode)return d("error",new _e("error",{status:e.statusCode,message:e.statusMessage})),void i();if(301===e.statusCode||307===e.statusCode)return e.headers.location?(307===e.statusCode&&(f=t),t=e.headers.location,void process.nextTick(p)):void d("error",new _e("error",{status:e.statusCode,message:e.statusMessage}));if(200!==e.statusCode)return d("error",new _e("error",{status:e.statusCode,message:e.statusMessage})),o.close();n=be.OPEN,e.on("close",function(){e.removeAllListeners("close"),e.removeAllListeners("end"),i()}),e.on("end",function(){e.removeAllListeners("close"),e.removeAllListeners("end"),i()}),d("open",new _e("open"));var r,s=!0;e.on("data",function(t){r=r?Buffer.concat([r,t]):t,s&&function(t){return pe.every(function(e,n){return t[n]===e})}(r)&&(r=r.slice(pe.length)),s=!1;for(var e=0,n=r.length;e<n;){a&&(r[e]===ve&&++e,a=!1);for(var o,i=-1,c=-1,u=e;i<0&&u<n;++u)(o=r[u])===de?c<0&&(c=u-e):o===ge?(a=!0,i=u-e):o===ve&&(i=u-e);if(i<0)break;m(r,e,c,i),e+=i+1}e===n?r=void 0:e>0&&(r=r.slice(e))})})).on("error",function(t){i(t.message)}),r.setNoDelay&&r.setNoDelay(!0),r.end()}function d(){o.listeners(arguments[0]).length>0&&o.emit.apply(o,arguments)}function m(e,n,r,i){if(0===i){if(c.length>0){var a=u||"message";d(a,new we(a,{data:c.slice(0,-1),lastEventId:s,origin:le(t)})),c=""}u=void 0}else if(r>0){var l=r<0,h=0,f=e.slice(n,n+(l?i:r)).toString();n+=h=l?i:e[n+r+1]!==me?r+1:r+2;var p=i-h,m=e.slice(n,n+p).toString();if("data"===f)c+=m+"\n";else if("event"===f)u=m;else if("id"===f)s=m;else if("retry"===f){var v=parseInt(m,10);Number.isNaN(v)||(o.reconnectInterval=v)}}}p(),this._close=function(){n!==be.CLOSED&&(n=be.CLOSED,r.abort&&r.abort(),r.xhr&&r.xhr.abort&&r.xhr.abort())}}var ye=be;function _e(t,e){if(Object.defineProperty(this,"type",{writable:!1,value:t,enumerable:!0}),e)for(var n in e)e.hasOwnProperty(n)&&Object.defineProperty(this,n,{writable:!1,value:e[n],enumerable:!0})}function we(t,e){for(var n in Object.defineProperty(this,"type",{writable:!1,value:t,enumerable:!0}),e)e.hasOwnProperty(n)&&Object.defineProperty(this,n,{writable:!1,value:e[n],enumerable:!0})}n.inherits(be,o.EventEmitter),be.prototype.constructor=be,["open","error","message"].forEach(function(t){Object.defineProperty(be.prototype,"on"+t,{get:function(){var e=this.listeners(t)[0];return e?e._listener?e._listener:e:void 0},set:function(e){this.removeAllListeners(t),this.addEventListener(t,e)}})}),Object.defineProperty(be,"CONNECTING",{enumerable:!0,value:0}),Object.defineProperty(be,"OPEN",{enumerable:!0,value:1}),Object.defineProperty(be,"CLOSED",{enumerable:!0,value:2}),be.prototype.CONNECTING=0,be.prototype.OPEN=1,be.prototype.CLOSED=2,be.prototype.close=function(){this._close()},be.prototype.addEventListener=function(t,e){"function"==typeof e&&(e._listener=e,this.on(t,e))},be.prototype.dispatchEvent=function(t){if(!t.type)throw new Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(t.type,t.detail)},be.prototype.removeEventListener=function(t,e){"function"==typeof e&&(e._listener=void 0,this.removeListener(t,e))};var Ee=o.EventEmitter,Ce=function(){};function Oe(t){Ce(t),Ee.call(this);var e=this,n=this.es=new ye(t);n.onmessage=function(t){Ce("message",t.data),e.emit("message",decodeURI(t.data))},n.onerror=function(t){Ce("error",n.readyState,t);var r=2!==n.readyState?"network":"permanent";e._cleanup(),e._close(r)}}"production"!==process.env.NODE_ENV&&(Ce=X("sockjs-client:receiver:eventsource")),tt(Oe,Ee),Oe.prototype.abort=function(){Ce("abort"),this._cleanup(),this._close("user")},Oe.prototype._cleanup=function(){Ce("cleanup");var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)},Oe.prototype._close=function(t){Ce("close",t);var e=this;setTimeout(function(){e.emit("close",null,t),e.removeAllListeners()},200)};var Se=Oe;function Ne(t){if(!Ne.enabled())throw new Error("Transport created when disabled");Gt.call(this,t,"/eventsource",Se,Yt)}tt(Ne,Gt),Ne.enabled=function(){return!!ye},Ne.transportName="eventsource",Ne.roundTrips=2;var xe=Ne,Te=b(function(t,e){(function(){var n={function:!0,object:!0},r=e&&!e.nodeType&&e,o=n[typeof window]&&window||this,i=r&&n.object&&t&&!t.nodeType&&"object"==typeof g&&g;function s(t,e){t||(t=o.Object()),e||(e=o.Object());var r=t.Number||o.Number,i=t.String||o.String,a=t.Object||o.Object,c=t.Date||o.Date,u=t.SyntaxError||o.SyntaxError,l=t.TypeError||o.TypeError,h=t.Math||o.Math,f=t.JSON||o.JSON;"object"==typeof f&&f&&(e.stringify=f.stringify,e.parse=f.parse);var p,d,m,v=a.prototype,g=v.toString,b=new c(-0xc782b5b800cec);try{b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(t){}function y(t){if(y[t]!==m)return y[t];var n;if("bug-string-char-index"==t)n="a"!="a"[0];else if("json"==t)n=y("json-stringify")&&y("json-parse");else{var o,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var a=e.stringify,u="function"==typeof a&&b;if(u){(o=function(){return 1}).toJSON=o;try{u="0"===a(0)&&"0"===a(new r)&&'""'==a(new i)&&a(g)===m&&a(m)===m&&a()===m&&"1"===a(o)&&"[1]"==a([o])&&"[null]"==a([m])&&"null"==a(null)&&"[null,null,null]"==a([m,g,null])&&a({a:[o,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===a(null,o)&&"[\n 1,\n 2\n]"==a([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==a(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==a(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==a(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==a(new c(-1))}catch(t){u=!1}}n=u}if("json-parse"==t){var l=e.parse;if("function"==typeof l)try{if(0===l("0")&&!l(!1)){var h=5==(o=l(s)).a.length&&1===o.a[0];if(h){try{h=!l('"\t"')}catch(t){}if(h)try{h=1!==l("01")}catch(t){}if(h)try{h=1!==l("1.")}catch(t){}}}}catch(t){h=!1}n=h}}return y[t]=!!n}if(!y("json")){var _=y("bug-string-char-index");if(!b)var w=h.floor,E=[0,31,59,90,120,151,181,212,243,273,304,334],C=function(t,e){return E[e]+365*(t-1970)+w((t-1969+(e=+(e>1)))/4)-w((t-1901+e)/100)+w((t-1601+e)/400)};if((p=v.hasOwnProperty)||(p=function(t){var e,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=g?p=function(t){var e=this.__proto__,n=t in(this.__proto__=null,this);return this.__proto__=e,n}:(e=n.constructor,p=function(t){var n=(this.constructor||e).prototype;return t in this&&!(t in n&&this[t]===n[t])}),n=null,p.call(this,t)}),d=function(t,e){var r,o,i,s=0;for(i in(r=function(){this.valueOf=0}).prototype.valueOf=0,o=new r)p.call(o,i)&&s++;return r=o=null,s?d=2==s?function(t,e){var n,r={},o="[object Function]"==g.call(t);for(n in t)o&&"prototype"==n||p.call(r,n)||!(r[n]=1)||!p.call(t,n)||e(n)}:function(t,e){var n,r,o="[object Function]"==g.call(t);for(n in t)o&&"prototype"==n||!p.call(t,n)||(r="constructor"===n)||e(n);(r||p.call(t,n="constructor"))&&e(n)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],d=function(t,e){var r,i,s="[object Function]"==g.call(t),a=!s&&"function"!=typeof t.constructor&&n[typeof t.hasOwnProperty]&&t.hasOwnProperty||p;for(r in t)s&&"prototype"==r||!a.call(t,r)||e(r);for(i=o.length;r=o[--i];a.call(t,r)&&e(r));}),d(t,e)},!y("json-stringify")){var O={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},S=function(t,e){return("000000"+(e||0)).slice(-t)},N=function(t){for(var e='"',n=0,r=t.length,o=!_||r>10,i=o&&(_?t.split(""):t);n<r;n++){var s=t.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=O[s];break;default:if(s<32){e+="\\u00"+S(2,s.toString(16));break}e+=o?i[n]:t.charAt(n)}}return e+'"'},x=function(t,e,n,r,o,i,s){var a,c,u,h,f,v,b,y,_,E,O,T,A,I,k,j;try{a=e[t]}catch(t){}if("object"==typeof a&&a)if("[object Date]"!=(c=g.call(a))||p.call(a,"toJSON"))"function"==typeof a.toJSON&&("[object Number]"!=c&&"[object String]"!=c&&"[object Array]"!=c||p.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&a<1/0){if(C){for(f=w(a/864e5),u=w(f/365.2425)+1970-1;C(u+1,0)<=f;u++);for(h=w((f-C(u,0))/30.42);C(u,h+1)<=f;h++);f=1+f-C(u,h),b=w((v=(a%864e5+864e5)%864e5)/36e5)%24,y=w(v/6e4)%60,_=w(v/1e3)%60,E=v%1e3}else u=a.getUTCFullYear(),h=a.getUTCMonth(),f=a.getUTCDate(),b=a.getUTCHours(),y=a.getUTCMinutes(),_=a.getUTCSeconds(),E=a.getUTCMilliseconds();a=(u<=0||u>=1e4?(u<0?"-":"+")+S(6,u<0?-u:u):S(4,u))+"-"+S(2,h+1)+"-"+S(2,f)+"T"+S(2,b)+":"+S(2,y)+":"+S(2,_)+"."+S(3,E)+"Z"}else a=null;if(n&&(a=n.call(e,t,a)),null===a)return"null";if("[object Boolean]"==(c=g.call(a)))return""+a;if("[object Number]"==c)return a>-1/0&&a<1/0?""+a:"null";if("[object String]"==c)return N(""+a);if("object"==typeof a){for(I=s.length;I--;)if(s[I]===a)throw l();if(s.push(a),O=[],k=i,i+=o,"[object Array]"==c){for(A=0,I=a.length;A<I;A++)T=x(A,a,n,r,o,i,s),O.push(T===m?"null":T);j=O.length?o?"[\n"+i+O.join(",\n"+i)+"\n"+k+"]":"["+O.join(",")+"]":"[]"}else d(r||a,function(t){var e=x(t,a,n,r,o,i,s);e!==m&&O.push(N(t)+":"+(o?" ":"")+e)}),j=O.length?o?"{\n"+i+O.join(",\n"+i)+"\n"+k+"}":"{"+O.join(",")+"}":"{}";return s.pop(),j}};e.stringify=function(t,e,r){var o,i,s,a;if(n[typeof e]&&e)if("[object Function]"==(a=g.call(e)))i=e;else if("[object Array]"==a){s={};for(var c,u=0,l=e.length;u<l;c=e[u++],("[object String]"==(a=g.call(c))||"[object Number]"==a)&&(s[c]=1));}if(r)if("[object Number]"==(a=g.call(r))){if((r-=r%1)>0)for(o="",r>10&&(r=10);o.length<r;o+=" ");}else"[object String]"==a&&(o=r.length<=10?r:r.slice(0,10));return x("",((c={})[""]=t,c),i,s,o,"",[])}}if(!y("json-parse")){var T,A,I=i.fromCharCode,k={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},j=function(){throw T=A=null,u()},L=function(){for(var t,e,n,r,o,i=A,s=i.length;T<s;)switch(o=i.charCodeAt(T)){case 9:case 10:case 13:case 32:T++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=_?i.charAt(T):i[T],T++,t;case 34:for(t="@",T++;T<s;)if((o=i.charCodeAt(T))<32)j();else if(92==o)switch(o=i.charCodeAt(++T)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=k[o],T++;break;case 117:for(e=++T,n=T+4;T<n;T++)(o=i.charCodeAt(T))>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||j();t+=I("0x"+i.slice(e,T));break;default:j()}else{if(34==o)break;for(o=i.charCodeAt(T),e=T;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++T);t+=i.slice(e,T)}if(34==i.charCodeAt(T))return T++,t;j();default:if(e=T,45==o&&(r=!0,o=i.charCodeAt(++T)),o>=48&&o<=57){for(48==o&&((o=i.charCodeAt(T+1))>=48&&o<=57)&&j(),r=!1;T<s&&((o=i.charCodeAt(T))>=48&&o<=57);T++);if(46==i.charCodeAt(T)){for(n=++T;n<s&&((o=i.charCodeAt(n))>=48&&o<=57);n++);n==T&&j(),T=n}if(101==(o=i.charCodeAt(T))||69==o){for(43!=(o=i.charCodeAt(++T))&&45!=o||T++,n=T;n<s&&((o=i.charCodeAt(n))>=48&&o<=57);n++);n==T&&j(),T=n}return+i.slice(e,T)}if(r&&j(),"true"==i.slice(T,T+4))return T+=4,!0;if("false"==i.slice(T,T+5))return T+=5,!1;if("null"==i.slice(T,T+4))return T+=4,null;j()}return"$"},F=function(t){var e,n;if("$"==t&&j(),"string"==typeof t){if("@"==(_?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];"]"!=(t=L());n||(n=!0))n&&(","==t?"]"==(t=L())&&j():j()),","==t&&j(),e.push(F(t));return e}if("{"==t){for(e={};"}"!=(t=L());n||(n=!0))n&&(","==t?"}"==(t=L())&&j():j()),","!=t&&"string"==typeof t&&"@"==(_?t.charAt(0):t[0])&&":"==L()||j(),e[t.slice(1)]=F(L());return e}j()}return t},P=function(t,e,n){var r=R(t,e,n);r===m?delete t[e]:t[e]=r},R=function(t,e,n){var r,o=t[e];if("object"==typeof o&&o)if("[object Array]"==g.call(o))for(r=o.length;r--;)P(o,r,n);else d(o,function(t){P(o,t,n)});return n.call(t,e,o)};e.parse=function(t,e){var n,r;return T=0,A=""+t,n=F(L()),"$"!=L()&&j(),T=A=null,e&&"[object Function]"==g.call(e)?R(((r={})[""]=n,r),"",e):n}}}return e.runInContext=s,e}if(!i||i.global!==i&&i.window!==i&&i.self!==i||(o=i),r)s(o,r);else{var a=o.JSON,c=o.JSON3,u=!1,l=s(o,o.JSON3={noConflict:function(){return u||(u=!0,o.JSON=a,o.JSON3=c,a=c=null),l}});o.JSON={parse:l.parse,stringify:l.stringify}}}).call(g)}),Ae=b(function(t){var e=function(){};"production"!==process.env.NODE_ENV&&(e=X("sockjs-client:utils:iframe")),t.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){t.exports.WPrefix in g||(g[t.exports.WPrefix]={})},postMessage:function(n,r){g.parent!==g?g.parent.postMessage(Te.stringify({windowId:t.exports.currentWindowId,type:n,data:r||""}),"*"):e("Cannot postMessage, no parent window.",n,r)},createIframe:function(t,n){var r,o,i=g.document.createElement("iframe"),s=function(){e("unattach"),clearTimeout(r);try{i.onload=null}catch(t){}i.onerror=null},a=function(){e("cleanup"),i&&(s(),setTimeout(function(){i&&i.parentNode.removeChild(i),i=null},0),w.unloadDel(o))},c=function(t){e("onerror",t),i&&(a(),n(t))};return i.src=t,i.style.display="none",i.style.position="absolute",i.onerror=function(){c("onerror")},i.onload=function(){e("onload"),clearTimeout(r),r=setTimeout(function(){c("onload timeout")},2e3)},g.document.body.appendChild(i),r=setTimeout(function(){c("timeout")},15e3),o=w.unloadAdd(a),{post:function(t,n){e("post",t,n),setTimeout(function(){try{i&&i.contentWindow&&i.contentWindow.postMessage(t,n)}catch(t){}},0)},cleanup:a,loaded:s}},createHtmlfile:function(n,r){var o,i,s,a=["Active"].concat("Object").join("X"),c=new g[a]("htmlfile"),u=function(){clearTimeout(o),s.onerror=null},l=function(){c&&(u(),w.unloadDel(i),s.parentNode.removeChild(s),s=c=null,CollectGarbage())},h=function(t){e("onerror",t),c&&(l(),r(t))};c.open(),c.write('<html><script>document.domain="'+g.document.domain+'";<\/script></html>'),c.close(),c.parentWindow[t.exports.WPrefix]=g[t.exports.WPrefix];var f=c.createElement("div");return c.body.appendChild(f),s=c.createElement("iframe"),f.appendChild(s),s.src=n,s.onerror=function(){h("onerror")},o=setTimeout(function(){h("timeout")},15e3),i=w.unloadAdd(l),{post:function(t,e){try{setTimeout(function(){s&&s.contentWindow&&s.contentWindow.postMessage(t,e)},0)}catch(t){}},cleanup:l,loaded:u}}},t.exports.iframeEnabled=!1,g.document&&(t.exports.iframeEnabled=("function"==typeof g.postMessage||"object"==typeof g.postMessage)&&!te.isKonqueror())}),Ie=(Ae.WPrefix,Ae.currentWindowId,Ae.polluteGlobalNamespace,Ae.postMessage,Ae.createIframe,Ae.createHtmlfile,Ae.iframeEnabled,o.EventEmitter),ke=function(){};function je(t,e,n){if(!je.enabled())throw new Error("Transport created when disabled");Ie.call(this);var r=this;this.origin=K.getOrigin(n),this.baseUrl=n,this.transUrl=e,this.transport=t,this.windowId=_.string(8);var o=K.addPath(n,"/iframe.html")+"#"+this.windowId;ke(t,e,o),this.iframeObj=Ae.createIframe(o,function(t){ke("err callback"),r.emit("close",1006,"Unable to load an iframe ("+t+")"),r.close()}),this.onmessageCallback=this._message.bind(this),w.attachEvent("message",this.onmessageCallback)}"production"!==process.env.NODE_ENV&&(ke=X("sockjs-client:transport:iframe")),tt(je,Ie),je.prototype.close=function(){if(ke("close"),this.removeAllListeners(),this.iframeObj){w.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(t){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},je.prototype._message=function(t){if(ke("message",t.data),K.isOriginEqual(t.origin,this.origin)){var e;try{e=Te.parse(t.data)}catch(e){return void ke("bad json",t.data)}if(e.windowId===this.windowId)switch(e.type){case"s":this.iframeObj.loaded(),this.postMessage("s",Te.stringify(["1.3.0",this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",e.data);break;case"c":var n;try{n=Te.parse(e.data)}catch(t){return void ke("bad json",e.data)}this.emit("close",n[0],n[1]),this.close()}else ke("mismatched window id",e.windowId,this.windowId)}else ke("not same origin",t.origin,this.origin)},je.prototype.postMessage=function(t,e){ke("postMessage",t,e),this.iframeObj.post(Te.stringify({windowId:this.windowId,type:t,data:e||""}),this.origin)},je.prototype.send=function(t){ke("send",t),this.postMessage("m",t)},je.enabled=function(){return Ae.iframeEnabled},je.transportName="iframe",je.roundTrips=2;var Le=je,Fe={isObject:function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},extend:function(t){if(!this.isObject(t))return t;for(var e,n,r=1,o=arguments.length;r<o;r++)for(n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}},Pe=function(t){function e(e,n){Le.call(this,t.transportName,e,n)}return tt(e,Le),e.enabled=function(e,n){if(!g.document)return!1;var r=Fe.extend({},n);return r.sameOrigin=!0,t.enabled(r)&&Le.enabled()},e.transportName="iframe-"+t.transportName,e.needBody=!0,e.roundTrips=Le.roundTrips+t.roundTrips-1,e.facadeTransport=t,e},Re=o.EventEmitter,De=function(){};function Me(t){De(t),Re.call(this);var e=this;Ae.polluteGlobalNamespace(),this.id="a"+_.string(6),t=K.addQuery(t,"c="+decodeURIComponent(Ae.WPrefix+"."+this.id)),De("using htmlfile",Me.htmlfileEnabled);var n=Me.htmlfileEnabled?Ae.createHtmlfile:Ae.createIframe;g[Ae.WPrefix][this.id]={start:function(){De("start"),e.iframeObj.loaded()},message:function(t){De("message",t),e.emit("message",t)},stop:function(){De("stop"),e._cleanup(),e._close("network")}},this.iframeObj=n(t,function(){De("callback"),e._cleanup(),e._close("permanent")})}"production"!==process.env.NODE_ENV&&(De=X("sockjs-client:receiver:htmlfile")),tt(Me,Re),Me.prototype.abort=function(){De("abort"),this._cleanup(),this._close("user")},Me.prototype._cleanup=function(){De("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete g[Ae.WPrefix][this.id]},Me.prototype._close=function(t){De("_close",t),this.emit("close",null,t),this.removeAllListeners()},Me.htmlfileEnabled=!1;var Ue=["Active"].concat("Object").join("X");if(Ue in g)try{Me.htmlfileEnabled=!!new g[Ue]("htmlfile")}catch(t){}Me.enabled=Me.htmlfileEnabled||Ae.iframeEnabled;var Ve=Me;function Ge(t){if(!Ve.enabled)throw new Error("Transport created when disabled");Gt.call(this,t,"/htmlfile",Ve,$t)}tt(Ge,Gt),Ge.enabled=function(t){return Ve.enabled&&t.sameOrigin},Ge.transportName="htmlfile",Ge.roundTrips=2;var We=Ge;function qe(t){if(!$t.enabled&&!Yt.enabled)throw new Error("Transport created when disabled");Gt.call(this,t,"/xhr",zt,Yt)}tt(qe,Gt),qe.enabled=function(t){return!t.nullOrigin&&(!(!$t.enabled||!t.sameOrigin)||Yt.enabled)},qe.transportName="xhr-polling",qe.roundTrips=2;var Be=qe;function ze(t){if(!se.enabled)throw new Error("Transport created when disabled");Gt.call(this,t,"/xhr",zt,se)}tt(ze,Gt),ze.enabled=ce.enabled,ze.transportName="xdr-polling",ze.roundTrips=2;var Je=ze,He=o.EventEmitter,Ze=function(){};function Qe(t){Ze(t);var e=this;He.call(this),Ae.polluteGlobalNamespace(),this.id="a"+_.string(6);var n=K.addQuery(t,"c="+encodeURIComponent(Ae.WPrefix+"."+this.id));g[Ae.WPrefix][this.id]=this._callback.bind(this),this._createScript(n),this.timeoutId=setTimeout(function(){Ze("timeout"),e._abort(new Error("JSONP script loaded abnormally (timeout)"))},Qe.timeout)}"production"!==process.env.NODE_ENV&&(Ze=X("sockjs-client:receiver:jsonp")),tt(Qe,He),Qe.prototype.abort=function(){if(Ze("abort"),g[Ae.WPrefix][this.id]){var t=new Error("JSONP user aborted read");t.code=1e3,this._abort(t)}},Qe.timeout=35e3,Qe.scriptErrorTimeout=1e3,Qe.prototype._callback=function(t){Ze("_callback",t),this._cleanup(),this.aborting||(t&&(Ze("message",t),this.emit("message",t)),this.emit("close",null,"network"),this.removeAllListeners())},Qe.prototype._abort=function(t){Ze("_abort",t),this._cleanup(),this.aborting=!0,this.emit("close",t.code,t.message),this.removeAllListeners()},Qe.prototype._cleanup=function(){if(Ze("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var t=this.script;t.parentNode.removeChild(t),t.onreadystatechange=t.onerror=t.onload=t.onclick=null,this.script=null}delete g[Ae.WPrefix][this.id]},Qe.prototype._scriptError=function(){Ze("_scriptError");var t=this;this.errorTimer||(this.errorTimer=setTimeout(function(){t.loadedOkay||t._abort(new Error("JSONP script loaded abnormally (onerror)"))},Qe.scriptErrorTimeout))},Qe.prototype._createScript=function(t){Ze("_createScript",t);var e,n=this,r=this.script=g.document.createElement("script");if(r.id="a"+_.string(8),r.src=t,r.type="text/javascript",r.charset="UTF-8",r.onerror=this._scriptError.bind(this),r.onload=function(){Ze("onload"),n._abort(new Error("JSONP script loaded abnormally (onload)"))},r.onreadystatechange=function(){if(Ze("onreadystatechange",r.readyState),/loaded|closed/.test(r.readyState)){if(r&&r.htmlFor&&r.onclick){n.loadedOkay=!0;try{r.onclick()}catch(t){}}r&&n._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===r.async&&g.document.attachEvent)if(te.isOpera())(e=this.script2=g.document.createElement("script")).text="try{var a = document.getElementById('"+r.id+"'); if(a)a.onerror();}catch(x){};",r.async=e.async=!1;else{try{r.htmlFor=r.id,r.event="onclick"}catch(t){}r.async=!0}void 0!==r.async&&(r.async=!0);var o=g.document.getElementsByTagName("head")[0];o.insertBefore(r,o.firstChild),e&&o.insertBefore(e,o.firstChild)};var Xe,Ye,Ke=Qe,$e=function(){};"production"!==process.env.NODE_ENV&&($e=X("sockjs-client:sender:jsonp"));var tn=function(t,e,n){$e(t,e),Xe||($e("createForm"),(Xe=g.document.createElement("form")).style.display="none",Xe.style.position="absolute",Xe.method="POST",Xe.enctype="application/x-www-form-urlencoded",Xe.acceptCharset="UTF-8",(Ye=g.document.createElement("textarea")).name="d",Xe.appendChild(Ye),g.document.body.appendChild(Xe));var r="a"+_.string(8);Xe.target=r,Xe.action=K.addQuery(K.addPath(t,"/jsonp_send"),"i="+r);var o=function(t){$e("createIframe",t);try{return g.document.createElement('<iframe name="'+t+'">')}catch(n){var e=g.document.createElement("iframe");return e.name=t,e}}(r);o.id=r,o.style.display="none",Xe.appendChild(o);try{Ye.value=e}catch(t){}Xe.submit();var i=function(t){$e("completed",r,t),o.onerror&&(o.onreadystatechange=o.onerror=o.onload=null,setTimeout(function(){$e("cleaning up",r),o.parentNode.removeChild(o),o=null},500),Ye.value="",n(t))};return o.onerror=function(){$e("onerror",r),i()},o.onload=function(){$e("onload",r),i()},o.onreadystatechange=function(t){$e("onreadystatechange",r,o.readyState,t),"complete"===o.readyState&&i()},function(){$e("aborted",r),i(new Error("Aborted"))}};function en(t){if(!en.enabled())throw new Error("Transport created when disabled");Mt.call(this,t,"/jsonp",tn,Ke)}tt(en,Mt),en.enabled=function(){return!!g.document},en.transportName="jsonp-polling",en.roundTrips=1,en.needBody=!0;var nn,rn=en,on=[xt,ne,ce,xe,Pe(xe),We,Pe(We),Be,Je,Pe(Be),rn],sn=Array.prototype,an=Object.prototype,cn=Function.prototype,un=String.prototype,ln=sn.slice,hn=an.toString,fn=function(t){return"[object Function]"===an.toString.call(t)},pn=function(t){return"[object String]"===hn.call(t)},dn=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}();nn=dn?function(t,e,n,r){!r&&e in t||Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(t,e,n,r){!r&&e in t||(t[e]=n)};var mn=function(t,e,n){for(var r in e)an.hasOwnProperty.call(e,r)&&nn(t,r,e[r],n)},vn=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)};function gn(){}mn(cn,{bind:function(t){var e=this;if(!fn(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var n=ln.call(arguments,1),r=Math.max(0,e.length-n.length),o=[],i=0;i<r;i++)o.push("$"+i);var s=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof s){var r=e.apply(this,n.concat(ln.call(arguments)));return Object(r)===r?r:this}return e.apply(t,n.concat(ln.call(arguments)))});return e.prototype&&(gn.prototype=e.prototype,s.prototype=new gn,gn.prototype=null),s}}),mn(Array,{isArray:function(t){return"[object Array]"===hn.call(t)}});var bn=Object("a"),yn="a"!==bn[0]||!(0 in bn);mn(sn,{forEach:function(t){var e=vn(this),n=yn&&pn(this)?this.split(""):e,r=arguments[1],o=-1,i=n.length>>>0;if(!fn(t))throw new TypeError;for(;++o<i;)o in n&&t.call(r,n[o],o,e)}},!function(t){var e=!0,n=!0;return t&&(t.call("foo",function(t,n,r){"object"!=typeof r&&(e=!1)}),t.call([1],function(){n="string"==typeof this},"x")),!!t&&e&&n}(sn.forEach));var _n=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);mn(sn,{indexOf:function(t){var e=yn&&pn(this)?this.split(""):vn(this),n=e.length>>>0;if(!n)return-1;var r,o,i=0;for(arguments.length>1&&(r=arguments[1],(o=+r)!=o?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(o>0||-1)*Math.floor(Math.abs(o))),i=o),i=i>=0?i:Math.max(0,n+i);i<n;i++)if(i in e&&e[i]===t)return i;return-1}},_n);var wn,En=un.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?(wn=void 0===/()??/.exec("")[1],un.split=function(t,e){var n=this;if(void 0===t&&0===e)return[];if("[object RegExp]"!==hn.call(t))return En.call(this,t,e);var r,o,i,s,a=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),u=0;for(t=new RegExp(t.source,c+"g"),n+="",wn||(r=new RegExp("^"+t.source+"$(?!\\s)",c)),e=void 0===e?-1>>>0:e>>>0;(o=t.exec(n))&&!((i=o.index+o[0].length)>u&&(a.push(n.slice(u,o.index)),!wn&&o.length>1&&o[0].replace(r,function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(o[t]=void 0)}),o.length>1&&o.index<n.length&&sn.push.apply(a,o.slice(1)),s=o[0].length,u=i,a.length>=e));)t.lastIndex===o.index&&t.lastIndex++;return u===n.length?!s&&t.test("")||a.push(""):a.push(n.slice(u)),a.length>e?a.slice(0,e):a}):"0".split(void 0,0).length&&(un.split=function(t,e){return void 0===t&&0===e?[]:En.call(this,t,e)});var Cn=un.substr,On="".substr&&"b"!=="0b".substr(-1);mn(un,{substr:function(t,e){return Cn.call(this,t<0&&(t=this.length+t)<0?0:t,e)}},On);var Sn,Nn=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,xn=function(t){var e=Te.stringify(t);return Nn.lastIndex=0,Nn.test(e)?(Sn||(Sn=function(t){var e,n={},r=[];for(e=0;e<65536;e++)r.push(String.fromCharCode(e));return t.lastIndex=0,r.join("").replace(t,function(t){return n[t]="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,n}(Nn)),e.replace(Nn,function(t){return Sn[t]})):e},Tn=function(){};"production"!==process.env.NODE_ENV&&(Tn=X("sockjs-client:utils:transport"));var An={};["log","debug","warn"].forEach(function(t){var e;try{e=g.console&&g.console[t]&&g.console[t].apply}catch(t){}An[t]=e?function(){return g.console[t].apply(g.console,arguments)}:"log"===t?function(){}:An.log});var In=An;function kn(t){this.type=t}kn.prototype.initEvent=function(t,e,n){return this.type=t,this.bubbles=e,this.cancelable=n,this.timeStamp=+new Date,this},kn.prototype.stopPropagation=function(){},kn.prototype.preventDefault=function(){},kn.CAPTURING_PHASE=1,kn.AT_TARGET=2,kn.BUBBLING_PHASE=3;var jn=kn;function Ln(){this._listeners={}}Ln.prototype.addEventListener=function(t,e){t in this._listeners||(this._listeners[t]=[]);var n=this._listeners[t];-1===n.indexOf(e)&&(n=n.concat([e])),this._listeners[t]=n},Ln.prototype.removeEventListener=function(t,e){var n=this._listeners[t];if(n){var r=n.indexOf(e);-1===r||(n.length>1?this._listeners[t]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[t])}},Ln.prototype.dispatchEvent=function(){var t=arguments[0],e=t.type,n=1===arguments.length?[t]:Array.apply(null,arguments);if(this["on"+e]&&this["on"+e].apply(this,n),e in this._listeners)for(var r=this._listeners[e],o=0;o<r.length;o++)r[o].apply(this,n)};var Fn=Ln,Pn=g.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""};function Rn(){jn.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}tt(Rn,jn);var Dn=Rn;function Mn(t){jn.call(this),this.initEvent("message",!1,!1),this.data=t}tt(Mn,jn);var Un=Mn,Vn=o.EventEmitter;function Gn(){var t=this;Vn.call(this),this.to=setTimeout(function(){t.emit("finish",200,"{}")},Gn.timeout)}tt(Gn,Vn),Gn.prototype.close=function(){clearTimeout(this.to)},Gn.timeout=2e3;var Wn=Gn,qn=o.EventEmitter,Bn=function(){};function zn(t,e){qn.call(this);var n=this,r=+new Date;this.xo=new e("GET",t),this.xo.once("finish",function(t,e){var o,i;if(200===t){if(i=+new Date-r,e)try{o=Te.parse(e)}catch(t){Bn("bad json",e)}Fe.isObject(o)||(o={})}n.emit("finish",o,i),n.removeAllListeners()})}"production"!==process.env.NODE_ENV&&(Bn=X("sockjs-client:info-ajax")),tt(zn,qn),zn.prototype.close=function(){this.removeAllListeners(),this.xo.close()};var Jn=zn,Hn=o.EventEmitter;function Zn(t){var e=this;Hn.call(this),this.ir=new Jn(t,$t),this.ir.once("finish",function(t,n){e.ir=null,e.emit("message",Te.stringify([t,n]))})}tt(Zn,Hn),Zn.transportName="iframe-info-receiver",Zn.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()};var Qn=Zn,Xn=o.EventEmitter,Yn=function(){};function Kn(t,e){var n=this;Xn.call(this);var r=function(){var r=n.ifr=new Le(Qn.transportName,e,t);r.once("message",function(t){if(t){var e;try{e=Te.parse(t)}catch(e){return Yn("bad json",t),n.emit("finish"),void n.close()}var r=e[0],o=e[1];n.emit("finish",r,o)}n.close()}),r.once("close",function(){n.emit("finish"),n.close()})};g.document.body?r():w.attachEvent("load",r)}"production"!==process.env.NODE_ENV&&(Yn=X("sockjs-client:info-iframe")),tt(Kn,Xn),Kn.enabled=function(){return Le.enabled()},Kn.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null};var $n=Kn,tr=o.EventEmitter,er=function(){};function nr(t,e){er(t);var n=this;tr.call(this),setTimeout(function(){n.doXhr(t,e)},0)}"production"!==process.env.NODE_ENV&&(er=X("sockjs-client:info-receiver")),tt(nr,tr),nr._getReceiver=function(t,e,n){return n.sameOrigin?new Jn(e,$t):Yt.enabled?new Jn(e,Yt):se.enabled&&n.sameScheme?new Jn(e,se):$n.enabled()?new $n(t,e):new Jn(e,Wn)},nr.prototype.doXhr=function(t,e){var n=this,r=K.addPath(t,"/info");er("doXhr",r),this.xo=nr._getReceiver(t,r,e),this.timeoutRef=setTimeout(function(){er("timeout"),n._cleanup(!1),n.emit("finish")},nr.timeout),this.xo.once("finish",function(t,e){er("finish",t,e),n._cleanup(!0),n.emit("finish",t,e)})},nr.prototype._cleanup=function(t){er("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!t&&this.xo&&this.xo.close(),this.xo=null},nr.prototype.close=function(){er("close"),this.removeAllListeners(),this._cleanup(!1)},nr.timeout=8e3;var rr=nr;function or(t){this._transport=t,t.on("message",this._transportMessage.bind(this)),t.on("close",this._transportClose.bind(this))}or.prototype._transportClose=function(t,e){Ae.postMessage("c",Te.stringify([t,e]))},or.prototype._transportMessage=function(t){Ae.postMessage("t",t)},or.prototype._send=function(t){this._transport.send(t)},or.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()};var ir=or,sr=function(){};"production"!==process.env.NODE_ENV&&(sr=X("sockjs-client:iframe-bootstrap"));var ar,cr=function(){};function ur(t,e,n){if(!(this instanceof ur))return new ur(t,e,n);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");Fn.call(this),this.readyState=ur.CONNECTING,this.extensions="",this.protocol="",(n=n||{}).protocols_whitelist&&In.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports,this._transportOptions=n.transportOptions||{};var r=n.sessionId||8;if("function"==typeof r)this._generateSessionId=r;else{if("number"!=typeof r)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return _.string(r)}}this._server=n.server||_.numberString(1e3);var o=new L(t);if(!o.host||!o.protocol)throw new SyntaxError("The URL '"+t+"' is invalid");if(o.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==o.protocol&&"https:"!==o.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+o.protocol+"' is not allowed.");var i="https:"===o.protocol;if("https:"===Pn.protocol&&!i)throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");e?Array.isArray(e)||(e=[e]):e=[];var s=e.sort();s.forEach(function(t,e){if(!t)throw new SyntaxError("The protocols entry '"+t+"' is invalid.");if(e<s.length-1&&t===s[e+1])throw new SyntaxError("The protocols entry '"+t+"' is duplicated.")});var a=K.getOrigin(Pn.href);this._origin=a?a.toLowerCase():null,o.set("pathname",o.pathname.replace(/\/+$/,"")),this.url=o.href,cr("using url",this.url),this._urlInfo={nullOrigin:!te.hasDomain(),sameOrigin:K.isOriginEqual(this.url,Pn.href),sameScheme:K.isSchemeEqual(this.url,Pn.href)},this._ir=new rr(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function lr(t){return 1e3===t||t>=3e3&&t<=4999}"production"!==process.env.NODE_ENV&&(cr=X("sockjs-client:main")),tt(ur,Fn),ur.prototype.close=function(t,e){if(t&&!lr(t))throw new Error("InvalidAccessError: Invalid code");if(e&&e.length>123)throw new SyntaxError("reason argument has an invalid length");if(this.readyState!==ur.CLOSING&&this.readyState!==ur.CLOSED){this._close(t||1e3,e||"Normal closure",!0)}},ur.prototype.send=function(t){if("string"!=typeof t&&(t=""+t),this.readyState===ur.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===ur.OPEN&&this._transport.send(xn(t))},ur.version="1.3.0",ur.CONNECTING=0,ur.OPEN=1,ur.CLOSING=2,ur.CLOSED=3,ur.prototype._receiveInfo=function(t,e){if(cr("_receiveInfo",e),this._ir=null,t){this._rto=this.countRTO(e),this._transUrl=t.base_url?t.base_url:this.url,t=Fe.extend(t,this._urlInfo),cr("info",t);var n=ar.filterToEnabled(this._transportsWhitelist,t);this._transports=n.main,cr(this._transports.length+" enabled transports"),this._connect()}else this._close(1002,"Cannot connect to server")},ur.prototype._connect=function(){for(var t=this._transports.shift();t;t=this._transports.shift()){if(cr("attempt",t.transportName),t.needBody&&(!g.document.body||void 0!==g.document.readyState&&"complete"!==g.document.readyState&&"interactive"!==g.document.readyState))return cr("waiting for body"),this._transports.unshift(t),void w.attachEvent("load",this._connect.bind(this));var e=this._rto*t.roundTrips||5e3;this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),e),cr("using timeout",e);var n=K.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),r=this._transportOptions[t.transportName];cr("transport url",n);var o=new t(n,this._transUrl,r);return o.on("message",this._transportMessage.bind(this)),o.once("close",this._transportClose.bind(this)),o.transportName=t.transportName,void(this._transport=o)}this._close(2e3,"All transports failed",!1)},ur.prototype._transportTimeout=function(){cr("_transportTimeout"),this.readyState===ur.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},ur.prototype._transportMessage=function(t){cr("_transportMessage",t);var e,n=this,r=t.slice(0,1),o=t.slice(1);switch(r){case"o":return void this._open();case"h":return this.dispatchEvent(new jn("heartbeat")),void cr("heartbeat",this.transport)}if(o)try{e=Te.parse(o)}catch(t){cr("bad json",o)}if(void 0!==e)switch(r){case"a":Array.isArray(e)&&e.forEach(function(t){cr("message",n.transport,t),n.dispatchEvent(new Un(t))});break;case"m":cr("message",this.transport,e),this.dispatchEvent(new Un(e));break;case"c":Array.isArray(e)&&2===e.length&&this._close(e[0],e[1],!0)}else cr("empty payload",o)},ur.prototype._transportClose=function(t,e){cr("_transportClose",this.transport,t,e),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),lr(t)||2e3===t||this.readyState!==ur.CONNECTING?this._close(t,e):this._connect()},ur.prototype._open=function(){cr("_open",this._transport.transportName,this.readyState),this.readyState===ur.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=ur.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new jn("open")),cr("connected",this.transport)):this._close(1006,"Server lost session")},ur.prototype._close=function(t,e,n){cr("_close",this.transport,t,e,n,this.readyState);var r=!1;if(this._ir&&(r=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===ur.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=ur.CLOSING,setTimeout(function(){this.readyState=ur.CLOSED,r&&this.dispatchEvent(new jn("error"));var o=new Dn("close");o.wasClean=n||!1,o.code=t||1e3,o.reason=e,this.dispatchEvent(o),this.onmessage=this.onclose=this.onerror=null,cr("disconnected")}.bind(this),0)},ur.prototype.countRTO=function(t){return t>100?4*t:300+t};var hr,fr=(ar=function(t){return{filterToEnabled:function(e,n){var r={main:[],facade:[]};return e?"string"==typeof e&&(e=[e]):e=[],t.forEach(function(t){t&&("websocket"!==t.transportName||!1!==n.websocket?e.length&&-1===e.indexOf(t.transportName)?Tn("not in whitelist",t.transportName):t.enabled(n)?(Tn("enabled",t.transportName),r.main.push(t),t.facadeTransport&&r.facade.push(t.facadeTransport)):Tn("disabled",t.transportName):Tn("disabled from server","websocket"))}),r}}}(hr=on),function(t,e){var n,r={};e.forEach(function(t){t.facadeTransport&&(r[t.facadeTransport.transportName]=t.facadeTransport)}),r[Qn.transportName]=Qn,t.bootstrap_iframe=function(){var e;Ae.currentWindowId=Pn.hash.slice(1),w.attachEvent("message",function(o){if(o.source===parent&&(void 0===n&&(n=o.origin),o.origin===n)){var i;try{i=Te.parse(o.data)}catch(t){return void sr("bad json",o.data)}if(i.windowId===Ae.currentWindowId)switch(i.type){case"s":var s;try{s=Te.parse(i.data)}catch(t){sr("bad json",i.data);break}var a=s[0],c=s[1],u=s[2],l=s[3];if(sr(a,c,u,l),a!==t.version)throw new Error('Incompatible SockJS! Main site uses: "'+a+'", the iframe: "'+t.version+'".');if(!K.isOriginEqual(u,Pn.href)||!K.isOriginEqual(l,Pn.href))throw new Error("Can't connect to different domain from within an iframe. ("+Pn.href+", "+u+", "+l+")");e=new ir(new r[c](u,l));break;case"m":e._send(i.data);break;case"c":e&&e._close(),e=null}}}),Ae.postMessage("s")}}(ur,hr),ur);"_sockjs_onload"in g&&setTimeout(g._sockjs_onload,1);var pr=b(function(t,e){(function(){var t,n,r,o,i={}.hasOwnProperty,s=[].slice;t={LF:"\n",NULL:"\0"},r=function(){var e;function n(t,e,n,r){this.command=t,this.headers=null!=e?e:{},this.body=null!=n?n:"",this.escapeHeaderValues=null!=r&&r}return n.prototype.toString=function(){var e,r,o,s,a;for(r in e=[this.command],(s=!1===this.headers["content-length"])&&delete this.headers["content-length"],o=this.headers)i.call(o,r)&&(a=o[r],this.escapeHeaderValues&&"CONNECT"!==this.command&&"CONNECTED"!==this.command?e.push(r+":"+n.frEscape(a)):e.push(r+":"+a));return this.body&&!s&&e.push("content-length:"+n.sizeOfUTF8(this.body)),e.push(t.LF+this.body),e.join(t.LF)},n.sizeOfUTF8=function(t){return t?encodeURI(t).match(/%..|./g).length:0},e=function(e,r){var o,i,s,a,c,u,l,h,f,p,d,m,v,g,b,y,_,w;for(null==r&&(r=!1),a=e.search(RegExp(""+t.LF+t.LF)),s=(c=e.substring(0,a).split(t.LF)).shift(),u={},w=function(t){return t.replace(/^\s+|\s+$/g,"")},f=0,m=(g=c.reverse()).length;f<m;f++)h=(v=g[f]).indexOf(":"),u[w(v.substring(0,h))]=r&&"CONNECT"!==s&&"CONNECTED"!==s?n.frUnEscape(w(v.substring(h+1))):w(v.substring(h+1));if(o="",_=a+2,u["content-length"])d=parseInt(u["content-length"]),o=(""+e).substring(_,_+d);else for(i=null,l=p=b=_,y=e.length;(b<=y?p<y:p>y)&&(i=e.charAt(l))!==t.NULL;l=b<=y?++p:--p)o+=i;return new n(s,u,o,r)},n.unmarshall=function(n,r){var o,i,s,a;return null==r&&(r=!1),i=n.split(RegExp(""+t.NULL+t.LF+"*")),(a={frames:[],partial:""}).frames=function(){var t,n,s,a;for(a=[],t=0,n=(s=i.slice(0,-1)).length;t<n;t++)o=s[t],a.push(e(o,r));return a}(),(s=i.slice(-1)[0])===t.LF||-1!==s.search(RegExp(""+t.NULL+t.LF+"*$"))?a.frames.push(e(s,r)):a.partial=s,a},n.marshall=function(e,r,o,i){return new n(e,r,o,i).toString()+t.NULL},n.frEscape=function(t){return(""+t).replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")},n.frUnEscape=function(t){return(""+t).replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\c/g,":").replace(/\\\\/g,"\\")},n}(),n=function(){var e;function n(t){this.ws_fn=function(){var e;return(e=t()).binaryType="arraybuffer",e},this.reconnect_delay=0,this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16384,this.subscriptions={},this.partialData=""}return n.prototype.debug=function(t){var e;return"undefined"!=typeof window&&null!==window&&null!=(e=window.console)?e.log(t):void 0},e=function(){return Date.now?Date.now():(new Date).valueOf},n.prototype._transmit=function(t,e,n){var o;for(o=r.marshall(t,e,n,this.escapeHeaderValues),"function"==typeof this.debug&&this.debug(">>> "+o);;){if(!(o.length>this.maxWebSocketFrameSize))return this.ws.send(o);this.ws.send(o.substring(0,this.maxWebSocketFrameSize)),o=o.substring(this.maxWebSocketFrameSize),"function"==typeof this.debug&&this.debug("remaining = "+o.length)}},n.prototype._setupHeartbeat=function(n){var r,i,s,a,c,u,l;if((r=n.version)===o.VERSIONS.V1_1||r===o.VERSIONS.V1_2)return a=(i=function(){var t,e,r,o;for(o=[],t=0,e=(r=n["heart-beat"].split(",")).length;t<e;t++)u=r[t],o.push(parseInt(u));return o}())[0],s=i[1],0!==this.heartbeat.outgoing&&0!==s&&(c=Math.max(this.heartbeat.outgoing,s),"function"==typeof this.debug&&this.debug("send PING every "+c+"ms"),this.pinger=o.setInterval(c,(l=this,function(){return l.ws.send(t.LF),"function"==typeof l.debug?l.debug(">>> PING"):void 0}))),0!==this.heartbeat.incoming&&0!==a?(c=Math.max(this.heartbeat.incoming,a),"function"==typeof this.debug&&this.debug("check PONG every "+c+"ms"),this.ponger=o.setInterval(c,function(t){return function(){var n;if((n=e()-t.serverActivity)>2*c)return"function"==typeof t.debug&&t.debug("did not receive server activity for the last "+n+"ms"),t.ws.close()}}(this))):void 0},n.prototype._parseConnect=function(){var t,e,n,r,o;if(o={},(t=1<=arguments.length?s.call(arguments,0):[]).length<2)throw"Connect requires at least 2 arguments";if("function"==typeof t[1])o=t[0],n=t[1],r=t[2],e=t[3];else switch(t.length){case 6:o.login=t[0],o.passcode=t[1],n=t[2],r=t[3],e=t[4],o.host=t[5];break;default:o.login=t[0],o.passcode=t[1],n=t[2],r=t[3],e=t[4]}return[o,n,r,e]},n.prototype.connect=function(){var t,e;return t=1<=arguments.length?s.call(arguments,0):[],this.escapeHeaderValues=!1,e=this._parseConnect.apply(this,t),this.headers=e[0],this.connectCallback=e[1],this.errorCallback=e[2],this.closeEventCallback=e[3],this._active=!0,this._connect()},n.prototype._connect=function(){var n,i,s,a,c;if(a=this.headers,s=this.errorCallback,i=this.closeEventCallback,this._active)return"function"==typeof this.debug&&this.debug("Opening Web Socket..."),this.ws=this.ws_fn(),n=function(t){var e,n,r,o,i,s;for(s="",i=t.length,o=0;o<i;)switch((e=t[o++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(e);break;case 12:case 13:n=t[o++],s+=String.fromCharCode((31&e)<<6|63&n);break;case 14:n=t[o++],r=t[o++],s+=String.fromCharCode((15&e)<<12|(63&n)<<6|(63&r)<<0)}return s},this.ws.onmessage=(c=this,function(i){var a,u,l,h,f,p,d,m,v,g,b;if(l="undefined"!=typeof ArrayBuffer&&i.data instanceof ArrayBuffer?(a=new Uint8Array(i.data),"function"==typeof c.debug&&c.debug("--- got data length: "+a.length),n(a)):i.data,c.serverActivity=e(),l!==t.LF)for("function"==typeof c.debug&&c.debug("<<< "+l),b=r.unmarshall(c.partialData+l,c.escapeHeaderValues),c.partialData=b.partial,f=0,p=(v=b.frames).length;f<p;f++)switch((h=v[f]).command){case"CONNECTED":if("function"==typeof c.debug&&c.debug("connected to server "+h.headers.server),c.connected=!0,c.version=h.headers.version,c.version===o.VERSIONS.V1_2&&(c.escapeHeaderValues=!0),!c._active)return void c.disconnect();c._setupHeartbeat(h.headers),"function"==typeof c.connectCallback&&c.connectCallback(h);break;case"MESSAGE":g=h.headers.subscription,(m=c.subscriptions[g]||c.onreceive)?(u=c,d=c.version===o.VERSIONS.V1_2?h.headers.ack:h.headers["message-id"],h.ack=function(t){return null==t&&(t={}),u.ack(d,g,t)},h.nack=function(t){return null==t&&(t={}),u.nack(d,g,t)},m(h)):"function"==typeof c.debug&&c.debug("Unhandled received MESSAGE: "+h);break;case"RECEIPT":h.headers["receipt-id"]===c.closeReceipt?(c.ws.onclose=null,c.ws.close(),c._cleanUp(),"function"==typeof c._disconnectCallback&&c._disconnectCallback()):"function"==typeof c.onreceipt&&c.onreceipt(h);break;case"ERROR":"function"==typeof s&&s(h);break;default:"function"==typeof c.debug&&c.debug("Unhandled frame: "+h)}else"function"==typeof c.debug&&c.debug("<<< PONG")}),this.ws.onclose=function(t){return function(e){var n;return n="Whoops! Lost connection to "+t.ws.url,"function"==typeof t.debug&&t.debug(n),"function"==typeof i&&i(e),t._cleanUp(),"function"==typeof s&&s(n),t._schedule_reconnect()}}(this),this.ws.onopen=function(t){return function(){return"function"==typeof t.debug&&t.debug("Web Socket Opened..."),a["accept-version"]=o.VERSIONS.supportedVersions(),a["heart-beat"]=[t.heartbeat.outgoing,t.heartbeat.incoming].join(","),t._transmit("CONNECT",a)}}(this);this.debug("Client has been marked inactive, will not attempt to connect")},n.prototype._schedule_reconnect=function(){if(this.reconnect_delay>0)return"function"==typeof this.debug&&this.debug("STOMP: scheduling reconnection in "+this.reconnect_delay+"ms"),this._reconnector=setTimeout((t=this,function(){return t.connected?"function"==typeof t.debug?t.debug("STOMP: already connected"):void 0:("function"==typeof t.debug&&t.debug("STOMP: attempting to reconnect"),t._connect())}),this.reconnect_delay);var t},n.prototype.disconnect=function(t,e){var n;if(null==e&&(e={}),this._disconnectCallback=t,this._active=!1,this.connected){e.receipt||(e.receipt="close-"+this.counter++),this.closeReceipt=e.receipt;try{return this._transmit("DISCONNECT",e)}catch(t){return n=t,"function"==typeof this.debug?this.debug("Ignoring error during disconnect",n):void 0}}},n.prototype._cleanUp=function(){if(this._reconnector&&clearTimeout(this._reconnector),this.connected=!1,this.subscriptions={},this.partial="",this.pinger&&o.clearInterval(this.pinger),this.ponger)return o.clearInterval(this.ponger)},n.prototype.send=function(t,e,n){return null==e&&(e={}),null==n&&(n=""),e.destination=t,this._transmit("SEND",e,n)},n.prototype.subscribe=function(t,e,n){var r;return null==n&&(n={}),n.id||(n.id="sub-"+this.counter++),n.destination=t,this.subscriptions[n.id]=e,this._transmit("SUBSCRIBE",n),r=this,{id:n.id,unsubscribe:function(t){return r.unsubscribe(n.id,t)}}},n.prototype.unsubscribe=function(t,e){return null==e&&(e={}),delete this.subscriptions[t],e.id=t,this._transmit("UNSUBSCRIBE",e)},n.prototype.begin=function(t){var e,n;return n=t||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:n}),e=this,{id:n,commit:function(){return e.commit(n)},abort:function(){return e.abort(n)}}},n.prototype.commit=function(t){return this._transmit("COMMIT",{transaction:t})},n.prototype.abort=function(t){return this._transmit("ABORT",{transaction:t})},n.prototype.ack=function(t,e,n){return null==n&&(n={}),this.version===o.VERSIONS.V1_2?n.id=t:n["message-id"]=t,n.subscription=e,this._transmit("ACK",n)},n.prototype.nack=function(t,e,n){return null==n&&(n={}),this.version===o.VERSIONS.V1_2?n.id=t:n["message-id"]=t,n.subscription=e,this._transmit("NACK",n)},n}(),(o={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.2,1.1,1.0"}},client:function(t,e){return null==e&&(e=["v10.stomp","v11.stomp","v12.stomp"]),new n(function(){return new(o.WebSocketClass||WebSocket)(t,e)})},over:function(t){return new n("function"==typeof t?t:function(){return t})},Frame:r}).setInterval=function(t,e){return setInterval(e,t)},o.clearInterval=function(t){return clearInterval(t)},null!==e&&(e.Stomp=o),"undefined"!=typeof window&&null!==window?window.Stomp=o:e||(self.Stomp=o)}).call(g)}),dr=(pr.Stomp,pr.Stomp),mr=pr.Stomp.over,vr=pr.Stomp.client;"function"!=typeof WebSocket&&(pr.Stomp.WebSocketClass=f.w3cwebsocket),dr.over=mr,dr.client=vr;const gr={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"url",name:"url",property:"url",placeholder:"http://127.0.0.1:15674/stomp"},{type:"string",label:"subject",name:"subject",property:"subject"},{type:"string",label:"login",name:"login",property:"login"},{type:"string",label:"passcode",name:"passcode",property:"passcode"},{type:"select",label:"data-format",name:"dataFormat",property:{options:[{display:"Plain Text",value:"text"},{display:"JSON",value:"json"}]}},{type:"checkbox",label:"debug",name:"debug",property:"debug"}]},br="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABOCAMAAADcmSJQAAAAUVBMVEVHcEwzMzNmZmbMzMwAAAA0AAA0ADSZmZn///8zNAAAHzMANABnAABnMzJnMWdnMwCaZJpmZzAxZkxnADOaZmVkmmTL/8rNmM0zMmf/zMuXzM2XfcQdAAAAAXRSTlMAQObYZgAAA5RJREFUeF7tmdl22zoMRXMOAFIek7S94/9/aFWRXFBM0zbV0KsP2XRe5NhbGATJ0kvhiy8kYobyXOtEaIbTE4OlrqA8V+tAnlRahTrPiVmW0gKXZkyfqVgc6e8CQEeZqbdAbeYzvBoAHWOGam/IGj9DrHcwFzsRqogjxR5yDQaL9ZoY5BPEtZkyYRZHAlE2itFvBhmZCq3bax211wyeiTxwyO1N3isG35k/9CvLE1QH5Lo2787kGTqDxStx6ymL2mUmeT6k2vo1AuM0SOxmEldbjjJGbMUDNXXwA6qIwJIC2V7jNuHq0JYpnTQkJvUAsQIIF1sik88vkzhAnGPG5RyBlvoKVDuyrQ8DD9rniC6RIvXaCHExu3dGZ1gOqt4id2hztlN6zzyVCxJJG6Wrq6f0lY9oy1EFqAZ6nNTEppME8djg2vvxvIbCbeJ6FLU2A/X/4cf//3VfkaDZPqq1A7iyFWSE6j/94sdnyLUhBsY3+uzoEZMPWUPzuNpt+DmnM7zb2PgWGiUB+f5v6q8N4mZvNd+wouaZsLIPUuQikYBihtIWR3fANZi5P0D57odXA3CqvaIzolsIBwC297TcIH6euLQ3zBu+x8xFDN0IFsJhfgW9Ca+KqZtBotp8/ustigjZiBk6M1F/hyXmxltvf5ezJqQhHgUkV5KjxNAGFF2Q6jJAYv8PxpqgTVJgrCOW/g6qOeg9pipi0TscAgrozbQTuyJ2wg6O7TtqUZALsUzq9ATv6EPgYoDESbaM6oCAQ4A+av1QZdFknqIOBvhQZeats1o4VIsPuZb1W1EiMUyb8IBH41rDqq+hCh2KlWjtZKsiM+9QGBasa3FcjU2UTs9DwcZocVxWJS7sbY9EOHyKNSXyZGnZSqwzR6hpBRQFxe/k2Io3DUkXW86DmbWHFHr2Atmavrws0xSwi09l4Zh3zcxz0MxEqcm8tFzpBUVlzcsfpKwjPlm1UhZgN3bC9r4bju0rbU6zUl6qiNsrvOblmbhJHSzMqisQb/VqpcTvTM0Mtguv33ffd2U3dmbQxm7kdlp5/cbMWnwMrzdWI6Acki+z/PJNbl2nuerq64neaZM7FcpWazwMLRVpfVzbtCpUmlIdxBt3QEyv2c1PoSISI8nTN8DHoA+BfavzKLceEDuWXwVsfJDRvoXu7jbbxVDw7g3sSQi0L4ZrBK1RScYo8tKHSCRBZLh8Sft/l9fM9PLH8sVPxYRe1ylX8kMAAAAASUVORK5CYII=";class yr extends(p(d(m))){static get image(){return yr._image||(yr._image=new Image,yr._image.src=br),yr._image}added(){this.app.isViewMode&&this._initStomp()}_initStomp(){var{url:t,debug:e=!1,subject:n,login:r,passcode:o,dataFormat:i="text"}=this.model,s=new fr(t);this._client=dr.over(s),e||(this._client.debug=(()=>{})),this._client.connect(r,o,()=>{console.info("Stomp connected!"),this._client.subscribe(n,t=>{this.data=this._convertDataFormat(t.body,i)})},()=>{console.info("Stomp connect failed!")},"/")}dispose(){try{this._client&&this._client.connected&&this._client.disconnect(()=>console.info("stomp subscrition disconnected"))}catch(t){console.error(t)}delete this._client,super.dispose()}disconnect(){}_draw(t){var{left:e,top:n,width:r,height:o}=this.bounds;t.beginPath(),t.drawImage(yr.image,e,n,r,o)}get nature(){return gr}}v.register("stomp",yr);export{yr as Stomp};
